<app-loading-indicator [isLoading]="isLoading()"></app-loading-indicator>
<app-tile-component
  [title]="'Properties'"
  [actionName]="'New Property'"
  [canAction]="permissions().canAddProperty"
  [isVisible]="true"
  (tileAction)="addProperty()"
  [noContent]="false"
  [notAllowed]="false"
>
  <div>
    <div class="properties-header">
      @if (hasChanges() && permissions().canAddProperty) {
        <div class="action-buttons">
          <app-button [variant]="'light'" [size]="'sm'" (click)="resetChanges()">Cancel</app-button>
          <app-button [variant]="'primary'" [size]="'sm'" (click)="saveChanges()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save' }}
          </app-button>
        </div>
      }
    </div>

    @if (errorMessage()) {
      <div class="error-banner">{{ errorMessage() }}</div>
    }

    @if (successMessage()) {
      <div class="success-banner">{{ successMessage() }}</div>
    }
  </div>
  <div class="properties-section">
    <div class="properties-list ps-2">
      @if (showAppNameProperty()) {
        <app-property-field
          [property]="appNameProperty()"
          [isResource]="true"
          (valueChange)="onPropertyChange(appNameProperty().name, $event)"
        ></app-property-field>
      }
      @if (showOutOfServiceProperty()) {
        <app-property-field
          [property]="outOfServiceProperty()"
          [isResource]="true"
          (valueChange)="onPropertyChange(outOfServiceProperty().name, $event)"
        ></app-property-field>
      }
      @for (property of properties(); track property.descriptorId) {
        <app-property-field
          [property]="property"
          [isResource]="true"
          [canEdit]="permissions().canAddProperty"
          [canDelete]="permissions().canAddProperty"
          (valueChange)="onPropertyChange(property.name, $event)"
          (resetChange)="onPropertyReset(property.name, $event)"
        ></app-property-field>
      }
    </div>
  </div>
</app-tile-component>
